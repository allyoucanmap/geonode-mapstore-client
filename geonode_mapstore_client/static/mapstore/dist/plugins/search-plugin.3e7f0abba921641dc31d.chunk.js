(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[5190],{60604:(e,t,r)=>{"use strict";r.d(t,{jJ:()=>n,oy:()=>o,yg:()=>a,vD:()=>i,W:()=>c,B1:()=>l,fU:()=>u,cY:()=>s});var n="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",o="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",a="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",i="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",c=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",o=arguments.length>3?arguments[3]:void 0;return{type:n,id:e,owner:t,actionType:r,options:o}},l=function(e,t){return{type:o,owner:e,options:t}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.owner;return{type:a,id:t,owner:r}},s=function(){return{type:i}}},80416:(e,t,r)=>{"use strict";r.d(t,{yS:()=>n,Zz:()=>o,ms:()=>a,ih:()=>i,OX:()=>c,sb:()=>l,K$:()=>u,k7:()=>s,cX:()=>p,x9:()=>f,vs:()=>d,oE:()=>y,Po:()=>m,qv:()=>h,cI:()=>b,g6:()=>v,I4:()=>g,l$:()=>E,Xv:()=>O,k3:()=>S,CQ:()=>_,R8:()=>I,HN:()=>T,sH:()=>P,c7:()=>R,_7:()=>C,eF:()=>A,O6:()=>w,ED:()=>j,RP:()=>k,sF:()=>N,VP:()=>x,He:()=>D,vO:()=>F,WO:()=>L,bh:()=>M,pV:()=>G,MK:()=>V,ZF:()=>Z,tV:()=>Y,Dv:()=>U,Yz:()=>B,kI:()=>H,XG:()=>q,A4:()=>z,Rp:()=>W,ct:()=>K,oh:()=>X,$h:()=>$,ud:()=>J,Qr:()=>Q,LR:()=>ee,nN:()=>te,UG:()=>re,F5:()=>ne,c9:()=>oe,Jh:()=>ae,Xy:()=>ie});var n="CHANGE_LAYER_PROPERTIES",o="LAYERS:CHANGE_LAYER_PARAMS",a="CHANGE_GROUP_PROPERTIES",i="TOGGLE_NODE",c="SORT_NODE",l="REMOVE_NODE",u="UPDATE_NODE",s="MOVE_NODE",p="LAYER_LOADING",f="LAYER_LOAD",d="LAYER_ERROR",y="ADD_LAYER",m="ADD_GROUP",h="REMOVE_LAYER",b="SHOW_SETTINGS",v="HIDE_SETTINGS",g="UPDATE_SETTINGS",E="REFRESH_LAYERS",O="LAYERS:UPDATE_LAYERS_DIMENSION",S="LAYERS_REFRESHED",_="LAYERS_REFRESH_ERROR",I="LAYERS:BROWSE_DATA",T="LAYERS:DOWNLOAD",P="LAYERS:CLEAR_LAYERS",R="LAYERS:SELECT_NODE",C="LAYERS:FILTER_LAYERS",A="LAYERS:SHOW_LAYER_METADATA",w="LAYERS:HIDE_LAYER_METADATA",j="LAYERS:UPDATE_SETTINGS_PARAMS";function k(e,t,r){return{type:b,node:e,nodeType:t,options:r}}function N(){return{type:v}}function x(e){return{type:g,options:e}}function D(e,t){return{type:n,newProperties:t,layer:e}}function F(e,t){return{type:o,layer:e,params:t}}function L(e,t){return{type:a,newProperties:t,group:e}}function M(e,t,r){return{type:i,node:e,nodeType:t,status:!r}}function G(e){return{type:"CONTEXT_NODE",node:e}}function V(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:c,node:e,order:t,sortLayers:r}}function Z(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:l,node:e,nodeType:t,removeEmpty:r}}function Y(e,t,r){return{type:u,node:e,nodeType:t,options:r}}function U(e,t,r){return{type:s,node:e,groupId:t,index:r}}function B(e){return{type:p,layerId:e}}function H(e,t){return{type:f,layerId:e,error:t}}function q(e,t,r){return{type:d,layerId:e,tilesCount:t,tilesErrorCount:r}}function z(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:y,layer:e,foreground:t}}function W(e,t,r){return{type:m,group:e,parent:t,options:r}}function K(e,t){return{type:n,layer:e,newProperties:{_v_:t||(new Date).getTime()}}}function X(e){return{type:S,layers:e}}function $(e,t){return{type:_,layers:e,error:t}}function J(e,t,r,n){return{type:O,dimension:e,value:t,options:r,layers:n}}function Q(e){return{type:I,layer:e}}function ee(e){return{type:T,layer:e}}function te(){return{type:P}}function re(e,t,r){return{type:R,id:e,nodeType:t,ctrlKey:r}}function ne(e){return{type:C,text:e}}function oe(e,t){return{type:A,metadataRecord:e,maskLoading:t}}function ae(){return{type:w}}function ie(e,t){return{type:j,newParams:e,update:t}}},1550:(e,t,r)=>{"use strict";r.d(t,{pP:()=>o,TR:()=>a,N7:()=>i,mq:()=>c,uv:()=>l,Qy:()=>u,IL:()=>s,Li:()=>p,OW:()=>f,ZO:()=>d,Um:()=>y,TF:()=>m,Ls:()=>h,Ec:()=>b,Eu:()=>v,JJ:()=>g,nZ:()=>E,YD:()=>O,GI:()=>S,Jb:()=>_,Uh:()=>I,LP:()=>T,xy:()=>P,o6:()=>R,FP:()=>C,Mo:()=>A,sO:()=>w,Px:()=>j,hd:()=>k,BV:()=>N,SO:()=>x,H0:()=>D,$X:()=>F,ou:()=>L,NE:()=>M});var n=r(97395),o="CHANGE_MAP_VIEW",a="CLICK_ON_MAP",i="CHANGE_MOUSE_POINTER",c="CHANGE_ZOOM_LVL",l="PAN_TO",u="ZOOM_TO_EXTENT",s="ZOOM_TO_POINT",p="CHANGE_MAP_CRS",f="CHANGE_MAP_SCALES",d="CHANGE_MAP_STYLE",y="CHANGE_ROTATION",m="CREATION_ERROR_LAYER",h="UPDATE_VERSION",b="INIT_MAP",v="RESIZE_MAP",g="CHANGE_MAP_LIMITS",E="SET_MAP_RESOLUTIONS",O="REGISTER_EVENT_LISTENER",S="UNREGISTER_EVENT_LISTENER",_="MOUSE_MOVE",I="MOUSE_OUT";function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{family:""};return(0,n.vU)({title:"warning",message:"map.errorLoadingFont",values:e,position:"tc",autoDismiss:10})}function P(e,t,r){return{type:s,pos:e,zoom:t,crs:r}}function R(e,t,r,n,a,i,c,l){return{type:o,center:e,zoom:t,bbox:r,size:n,mapStateSource:a,projection:i,viewerOptions:c,resolution:l}}function C(e,t){return{type:a,point:e,layer:t}}function A(e){return{type:i,pointer:e}}function w(e,t){return{type:c,zoom:e,mapStateSource:t}}function j(e,t,r,n){return{type:u,extent:e,crs:t,maxZoom:r,options:n}}function k(e,t){return{type:d,style:e,mapStateSource:t}}function N(e){var t=e.restrictedExtent,r=e.crs,n=e.minZoom;return{type:g,restrictedExtent:t,crs:r,minZoom:n}}function x(e){return{type:E,resolutions:e}}var D=function(e,t){return{type:O,eventName:e,toolName:t}},F=function(e,t){return{type:S,eventName:e,toolName:t}},L=function(e){return{type:_,position:e}},M=function(){return{type:I}}},21914:(e,t,r)=>{"use strict";r.d(t,{XL:()=>o,km:()=>a,Ih:()=>i,Xw:()=>c,Pn:()=>l,DZ:()=>u,e8:()=>s,E0:()=>p,F9:()=>f,X_:()=>d,pb:()=>y,qb:()=>m,Re:()=>h,ih:()=>b,xy:()=>v,jL:()=>g,oz:()=>E,ph:()=>O,lF:()=>S,gG:()=>_,cb:()=>I,GI:()=>T,B1:()=>P,fv:()=>R,gc:()=>C,zX:()=>A,ZF:()=>w,Zb:()=>j,Fm:()=>k,sV:()=>N,Mn:()=>x,LU:()=>D,XP:()=>F,WU:()=>L,JB:()=>M,g:()=>G,ws:()=>V,HP:()=>Z,aN:()=>Y,Pg:()=>B,u0:()=>H,TM:()=>q,PM:()=>z,lK:()=>W,sv:()=>K,MO:()=>X,oO:()=>$,Mc:()=>J,Zw:()=>Q,RA:()=>ee,am:()=>te,ZM:()=>re,wm:()=>ne,Y$:()=>oe});var n=r(47310),o="LOAD_FEATURE_INFO",a="ERROR_FEATURE_INFO",i="EXCEPTIONS_FEATURE_INFO",c="CHANGE_MAPINFO_STATE",l="NEW_MAPINFO_REQUEST",u="PURGE_MAPINFO_RESULTS",s="CHANGE_MAPINFO_FORMAT",p="SHOW_MAPINFO_MARKER",f="HIDE_MAPINFO_MARKER",d="SHOW_REVERSE_GEOCODE",y="HIDE_REVERSE_GEOCODE",m="GET_VECTOR_INFO",h="NO_QUERYABLE_LAYERS",b="CLEAR_WARNING",v="FEATURE_INFO_CLICK",g="IDENTIFY:UPDATE_FEATURE_INFO_CLICK_POINT",E="IDENTIFY:TOGGLE_HIGHLIGHT_FEATURE",O="TOGGLE_MAPINFO_STATE",S="UPDATE_CENTER_TO_MARKER",_="IDENTIFY:CHANGE_PAGE",I="IDENTIFY:CLOSE_IDENTIFY",T="IDENTIFY:CHANGE_FORMAT",P="IDENTIFY:TOGGLE_SHOW_COORD_EDITOR",R="IDENTIFY:EDIT_LAYER_FEATURES",C="IDENTIFY:CURRENT_EDIT_FEATURE_QUERY",A="IDENTIFY:SET_MAP_TRIGGER",w="IDENTIFY:TOGGLE_EMPTY_MESSAGE_GFI",j="IDENTIFY:SET_SHOW_IN_MAP_POPUP";function k(e,t,r,n,a){return{type:o,data:t,reqId:e,requestParams:r,layerMetadata:n,layer:a}}function N(e,t,r,n){return{type:a,error:t,reqId:e,requestParams:r,layerMetadata:n}}function x(e,t,r,n){return{type:i,reqId:e,exceptions:t,requestParams:r,layerMetadata:n}}function D(){return{type:h}}function F(){return{type:b}}function L(e,t){return{type:l,reqId:e,request:t}}function M(e,t,r,n){return{type:m,layer:e,request:t,metadata:r,queryableLayers:n}}function G(){return{type:u}}function V(e){return{type:s,infoFormat:e}}function Z(){return{type:p}}function Y(){return{type:f}}function U(e){return{type:d,reverseGeocodeData:e.data}}function B(e){return function(t){n.Z.reverseGeocode(e).then((function(e){t(U(e))})).catch((function(e){t(U(e))}))}}function H(){return{type:y}}function q(){return{type:O}}function z(e){return{type:S,status:e}}function W(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return{type:v,point:e,layer:t,filterNameList:r,overrideParams:n,itemId:o}}function K(e){return{type:g,point:e}}function X(e){return{type:E,enabled:e}}function $(e){return{type:_,index:e}}var J=function(){return{type:I}},Q=function(e){return{type:T,format:e}},ee=function(e){return{type:P,showCoordinateEditor:e}},te=function(e){return{type:R,layer:e}},re=function(e){return{type:C,query:e}},ne=function(e){return{type:A,trigger:e}},oe=function(e){return{type:j,value:e}}},47310:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(75875),o=r.n(n),a=r(72500),i=r.n(a),c=r(27418),l=r.n(c),u={format:"json",bounded:0,polygon_geojson:1,priority:5};const s={geocode:function(e,t){var r=l()({q:e},u,t||{}),n=i().format({protocol:"https",host:"nominatim.openstreetmap.org",query:r});return o().get(n)},reverseGeocode:function(e,t){var r=l()({lat:e.lat,lon:e.lng},t||{},u),n=i().format({protocol:"https",host:"nominatim.openstreetmap.org/reverse",query:r});return o().get(n)}}},15047:(e,t,r)=>{"use strict";r.d(t,{b:()=>m});var n=r(27418),o=r.n(n);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(e){return null===e?[]:e.map((function(e){return{properties:i({},e),id:e.osm_id,type:"Feature",bbox:e.boundingbox.map((function(e){return parseFloat(e)})).reduce((function(e,t,r){return e[function(e){switch(e){case 0:return 1;case 1:return 3;case 2:return 0;case 3:return 2;default:return-1}}(r)]=t,e}),[]),geometry:e.geojson||{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}}}))},u=r(59286),s=r(32420),p=["url","typeName","queriableAttributes","outputFormat","predicate","staticFilter","blacklist","item","fromTextToFilter","returnFullData"];var f=function(e){var t,r=e.searchText,n=e.staticFilter,o=e.blacklist,a=e.item,i=e.queriableAttributes,c=e.predicate,l=(0,u.generateTemplateString)(n||"")(a),s=r.split(" ").filter((function(e){return e})).filter((function(e){return o.indexOf(e.toLowerCase())<0}));return 0===s.length&&(s=r?[r]:[]),s.length>0&&(t="(".concat(s.map((function(e){return i.map((function(t){return"".concat(t," ").concat(c," '%").concat(e.replace("'","''"),"%'")})).join(" OR ")})).join(") AND (")).concat(")")),t?t.concat(l):l||null},d={nominatim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{returnFullData:!1};return r(47310).Z.geocode(e,t).then((function(e){return t.returnFullData?e:l(e.data)}))},wfs:function(e,t){var r=t.url,n=t.typeName,a=t.queriableAttributes,i=void 0===a?[]:a,c=t.outputFormat,l=void 0===c?"application/json":c,u=t.predicate,d=void 0===u?"ILIKE":u,y=t.staticFilter,m=void 0===y?"":y,h=t.blacklist,b=void 0===h?[]:h,v=t.item,g=t.fromTextToFilter,E=void 0===g?f:g,O=t.returnFullData,S=void 0!==O&&O,_=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,p),I=E({searchText:e,staticFilter:m,blacklist:b,item:v,queriableAttributes:i,predicate:d});return s.DH(r,o()({maxFeatures:10,typeName:n,outputFormat:l,cql_filter:I},_)).then((function(e){return S?e:e.features}))}},y={setService:function(e,t){d[e]=t},getService:function(e){return d[e]?d[e]:null}},m={Services:d,Utils:y}},38167:(e,t,r)=>{"use strict";r.d(t,{k9:()=>O,v0:()=>E,ZP:()=>_});var n=r(45697),o=r.n(n),a=r(24852),i=r.n(a),c=r(68195);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(l,e);var t,r,n,o,a=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(n);if(o){var r=y(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return d(this,e)});function l(){return s(this,l),a.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){return this.context.intl?i().createElement(c.FormattedDate,u({value:this.props.value},this.props.dateParams)):i().createElement("span",null,this.props.value&&this.props.value.toString()||"")}}])&&p(t.prototype,r),l}(i().Component);m(h,"propTypes",{value:o().object,dateParams:o().object}),m(h,"contextTypes",{intl:o().object}),m(h,"defaultProps",{value:new Date});const b=h;var v=r(15402),g=r(5346),E=g.Z,O=v.Z,S=b;const _={Message:g.Z,HTML:O,DateFormat:S}},61012:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Xt});var n=r(27361),o=r.n(n),a=r(1469),i=r.n(a),c=r(27418),l=r.n(c),u=r(45697),s=r.n(u),p=r(24852),f=r.n(p),d=r(71703),y=r(1852),m=r.n(y),h=r(22222),b=r(60604),v=r(81808),g=r(82904),E=r(1550),O=r(97222);function S(e,t){return{type:"SET_SEARCH_BOOKMARK_CONFIG",property:e,value:t}}var _=r(30294),I=r(41609),T=r.n(I),P=r(52353),R=r.n(P),C=r(5346),A=r(15135),w=r(23570),j=r.n(w);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var N=(0,A.Z)(_.DropdownButton),x={disabled:!1,className:"square-button-md",noCaret:!0,idDropDown:j()()},D={title:f().createElement(_.Glyphicon,{glyph:"menu-hamburger"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0};const F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.menuItems,r=void 0===t?[]:t,n=e.disabled,o=void 0!==n&&n;return f().createElement(N,k({disabled:o},x,D),r.length?r.map((function(e){return e})):null)},L=function(e){var t=e.className,r=e.style,n=e.children;return f().createElement("div",{id:"map-search-bar",style:r,className:"MapSearchBar"+(t?" "+t:"")},n)};var M=r(86638);function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Z=function(e,t){var r=e.show,n=e.autoFocusOnSelect,o=void 0===n||n,a=e.selectedItems,i=void 0===a?[]:a,c=e.className,l=e.style,u=void 0===l?{textOverflow:"ellipsis"}:l,s=e.placeholder,p=e.placeholderMsgId,d=e.hideOnBlur,y=void 0===d||d,m=e.searchText,h=void 0===m?"":m,b=e.typeAhead,v=void 0===b||b,g=e.delay,E=void 0===g?1e3:g,O=e.blurResetDelay,S=void 0===O?300:O,I=e.onSearch,T=void 0===I?function(){}:I,P=e.onSearchTextChange,R=void 0===P?function(){}:P,C=e.onCancelSelectedItem,A=void 0===C?function(){}:C,w=e.onPurgeResults,j=void 0===w?function(){}:w,k=f().useRef(),N=f().useRef(),x=G(f().useState(),2),D=x[0],F=x[1],L=G(f().useState(),2),V=L[0],Z=L[1],Y=G(f().useState(!1),2),U=Y[0],B=Y[1];f().useEffect((function(){var e=N.current;if(o&&i&&(e<i.length||!e&&1===i.length)){var t=k.current;t&&t.focus instanceof Function&&setTimeout((function(){return t.focus()}),200)}N.current=i&&i.length})),f().useEffect((function(){U&&(T(),B(!1))}),[U,T]);var H="search.addressSearch";if(!s&&t.messages){var q=(0,M.S$)(t.messages,p||H);q&&(H=q)}else H=s;return r&&f().createElement(_.FormControl,{className:"searchInput".concat(c?" ".concat(c):""),key:"search-input",placeholder:H,type:"text",inputRef:function(e){k.current=e},style:u,value:h,onKeyDown:function(e){switch(e.keyCode){case 13:T();break;case 8:!h&&i&&i.length>0&&A(i[i.length-1])}},onBlur:function(){y&&(D&&clearTimeout(D),F(setTimeout((function(){j()}),S)))},onFocus:function(){v&&h&&T()},onChange:function(e){var t=e.target.value;R(t),v&&(V&&clearTimeout(V),Z(setTimeout((function(){B(!0)}),E)))}})};Z.contextTypes={messages:s().object};const Y=Z;var U=r(72986),B=r.n(U),H=r(80717);function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){K(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const X=function(e){var t=e.loading,r=(e.splitTools,e.toolbarProps),n=void 0===r?{}:r,o=e.toolbarButtons,a=void 0===o?[]:o,i=e.children;return f().createElement("span",{className:"search-toolbar-options"},t&&f().createElement(B(),{style:l()({},{position:"absolute"},W({},{right:"69px",zIndex:1,top:"13px"})),spinnerName:"pulse",noFadeIn:!0}),f().createElement(H.Z,q({btnGroupProps:{className:"btn-group-menu-options"},transitionProps:null,btnDefaultProps:{className:"square-button-md",bsStyle:"primary"}},n,{buttons:a})),i)};var $=r(43129);function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){ne(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var oe=(0,r(93451).Z)(["placeholder","clearValueText","noResultsText"])($.ZP),ae={searchByBookmark:function(e,t,r,n,o){var a,i,c=e.options,l=void 0===c?{}:c,u=e.layerVisibilityReload;void 0!==u&&u?t(re(re({},r),{},{map:re(re({},r.map),{},{bookmark_search_config:n})}),null,{bounds:[l.west,l.south,l.east,l.north],crs:(null==r||null===(a=r.map)||void 0===a||null===(i=a.center)||void 0===i?void 0:i.crs)||"EPSG:4326"}):l&&!T()(l)&&o([l.west,l.south,l.east,l.north],"EPSG:4326")},searchIcon:function(e,t){var r=t.onLayerVisibilityLoad,n=t.mapInitial,o=t.bookmarkConfig,a=t.onZoomToExtent;return{tooltipId:"bookmarkSearch"===e?"search.zoomToBookmark":"",tooltipPosition:"bottom",visible:"bookmarkSearch"===e&&!(null!=o&&o.zoomOnSelect),disabled:"bookmarkSearch"===e&&!o.selected,onClick:function(){"bookmarkSearch"===e&&ae.searchByBookmark(o.selected,r,n,o.bookmarkSearchConfig||{},a)}}}},ie=function(e){var t=e.bookmarkConfig,r=e.onPropertyChange,n=e.onLayerVisibilityLoad,o=e.mapInitial,a=e.onZoomToExtent,i=Q((0,p.useState)([]),2),c=i[0],l=i[1],u=t||{},s=u.selected,d=void 0===s?{}:s,y=u.bookmarkSearchConfig,m=void 0===y?{}:y,h=u.zoomOnSelect,b=void 0===h||h,v=m.bookmarks,g=void 0===v?[]:v,E=ae.searchByBookmark;return(0,p.useEffect)((function(){T()(g)||l(g.map((function(e){return e.title})))}),[g]),f().createElement("div",{className:"search-select"},f().createElement("div",{style:{flex:"1 1 0%",padding:"0px 4px"}},f().createElement(oe,J({},{clearable:!0,isSearchable:!0,isClearable:!0},{onChange:function(e){var t=e&&e.value||"",i=Q(g.filter((function(r,n){return r.title===t&&n===e.idx})),1)[0];r("selected",i),b&&E(i,n,o,m,a)},value:(null==d?void 0:d.title)||"",options:c.map((function(e,t){return{label:e,value:e,idx:t}})),placeholder:"search.b_placeholder",clearValueText:"search.b_clearvalue",noResultsText:"search.b_noresult"}))))};ie.propTypes={bookmarkConfig:s().object.isRequired,onPropertyChange:s().func.isRequired};const ce=(0,d.connect)((function(e){return{bookmarkConfig:e.searchbookmarkconfig||{}}}),{onPropertyChange:S,onZoomToExtent:E.Px,onLayerVisibilityLoad:v.H0})(ie);var le=r(81763),ue=r.n(le),se=r(99509),pe=r(77900),fe={clearCoordinates:function(e,t){e({owner:"search"}),t("lat",""),t("lon","")},areValidCoordinates:function(e){return ue()(null==e?void 0:e.lon)&&ue()(null==e?void 0:e.lat)},zoomToPoint:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;e({x:parseFloat(t.lon),y:parseFloat(t.lat)},r,"EPSG:4326")},coordinateFormatChange:function(e,t,r,n){return{buttonConfig:{title:f().createElement(_.Glyphicon,{glyph:"cog"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0},menuOptions:[{active:"decimal"===e,onClick:function(){return t("decimal")},text:f().createElement(C.Z,{msgId:"search.decimal"})},{active:"aeronautical"===e,onClick:function(){return t("aeronautical")},text:f().createElement(C.Z,{msgId:"search.aeronautical"})}],visible:r&&"coordinatesSearch"===n,Element:pe.Z}},removeIcon:function(e,t,r,n){return{visible:"coordinatesSearch"===e&&(ue()(t.lon)||ue()(t.lat)),onClick:function(){return fe.clearCoordinates(r,n)}}},searchIcon:function(e,t,r,n){return{visible:"coordinatesSearch"===e,onClick:function(){"coordinatesSearch"===e&&fe.areValidCoordinates(t)&&fe.zoomToPoint(r,t,n)}}},coordinatesMenuItem:function(e){var t=e.activeTool,r=e.searchText,n=e.clearSearch,o=e.onChangeActiveSearchTool,a=e.onClearBookmarkSearch;return f().createElement(_.MenuItem,{active:"coordinatesSearch"===t,onClick:function(){void 0!==r&&""!==r&&n(),a("selected"),o("coordinatesSearch"),document.dispatchEvent(new MouseEvent("click"))}},f().createElement(_.Glyphicon,{glyph:"search-coords"})," ",f().createElement(C.Z,{msgId:"search.coordinatesSearch"}))}},de=function(e){var t=e.coordinate,r=void 0===t?{}:t,n=e.format,o=e.onClearCoordinatesSearch,a=e.onZoomToPoint,i=e.onChangeCoord,c=e.defaultZoomLevel,l=e.aeronauticalOptions,u=void 0===l?{seconds:{decimals:4,step:1e-4}}:l,s=e.constraintsCoordEditor,p=void 0===s?{decimal:{lat:{min:-90,max:90},lon:{min:-180,max:180}}}:s,d=fe.zoomToPoint,y=fe.areValidCoordinates,m=function(e,t){i(e,parseFloat(t)),y()||o({owner:"search"})},h=function(){d(a,r,c)};return f().createElement("div",{className:"coordinateEditor",style:{flexWrap:"decimal"===n?"nowrap":"wrap"}},f().createElement(_.Row,{className:"entryRow ".concat(n)},f().createElement(_.FormGroup,null,f().createElement(_.InputGroup,null,f().createElement(_.InputGroup.Addon,{style:{minWidth:45}},f().createElement(C.Z,{msgId:"search.latitude"})),f().createElement(se.Z,{format:n,aeronauticalOptions:u,coordinate:"lat",idx:1,value:r.lat,constraints:p,onChange:function(e){return m("lat",e)},onKeyDown:function(){y(r)&&h()}})))),f().createElement(_.Row,{className:"entryRow ".concat(n)},f().createElement(_.FormGroup,null,f().createElement(_.InputGroup,null,f().createElement(_.InputGroup.Addon,{style:{minWidth:45}},f().createElement(C.Z,{msgId:"search.longitude"})),f().createElement(se.Z,{format:n,aeronauticalOptions:u,coordinate:"lon",idx:2,value:r.lon,constraints:p,onChange:function(e){return m("lon",e)},onKeyDown:function(){y(r)&&h()}})))))};de.propTypes={coordinate:s().object,format:s().string,onClearCoordinatesSearch:s().func,onZoomToPoint:s().func,onChangeCoord:s().func,defaultZoomLevel:s().number};const ye=(0,d.connect)((function(e){return{coordinate:e.search.coordinate||{}}}),{onZoomToPoint:O.Z,onChangeCoord:O.TS})(de);var me=["activeSearchTool","removeIcon","searchIcon","isSearchClickable","splitTools","searchText","maxResults","searchOptions","loading","delay","blurResetDelay","typeAhead","coordinate","selectedItems","defaultZoomLevel","enabledSearchBookmarkConfig","error","format","placeholder","placeholderMsgId","showOptions","showAddressSearchOption","showCoordinatesSearchOption","showBookMarkSearchOption","onSearch","onSearchReset","onSearchTextChange","onCancelSelectedItem","onChangeCoord","onChangeActiveSearchTool","onClearCoordinatesSearch","onChangeFormat","onToggleControl","onZoomToPoint","onClearBookmarkSearch","onPurgeResults","items"];function he(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return be(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?be(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){Ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Oe=r(13311),Se=r.n(Oe),_e=r(59286);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?Ae(e):t}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(c,e);var t,r,n,a,i=(n=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=we(n);if(a){var r=we(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ce(this,e)});function c(){var e;Te(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return je(Ae(e=i.call.apply(i,[this].concat(r))),"onClick",(function(){var t=e.props.item;e.props.onItemClick(t)})),e}return t=c,(r=[{key:"render",value:function(){if(void 0===this.props.item)return null;var e=this.props.item;return f().createElement("div",{key:e.osm_id,className:"search-result",style:e.resultCssStyle,onClick:this.onClick},f().createElement("div",{className:"search-result-left-container"},f().createElement("div",{className:"icon"}," ",f().createElement("img",{src:e.icon})),f().createElement("div",{className:"text-result-title"},o()(e,this.props.displayName)||(0,_e.generateTemplateString)(this.props.displayName||"")(e)),f().createElement("small",{className:"text-info"},this.props.subTitle&&o()(e,this.props.subTitle)||(0,_e.generateTemplateString)(this.props.subTitle||"")(e))),f().createElement("div",{className:"search-result-right-container"},f().createElement("div",{className:"search-result-tools"},f().createElement(H.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:this.props.tools}))))}}])&&Pe(t.prototype,r),c}(f().Component);je(ke,"propTypes",{subTitle:s().string,item:s().object,displayName:s().string,idField:s().string,icon:s().string,onItemClick:s().func,tools:s().array}),je(ke,"defaultProps",{displayName:"properties.display_name",idField:"id",icon:"properties.icon",tools:[]});const Ne=ke;var xe=r(38167),De=r(18412);function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?Ze(e):t}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ye(n);if(o){var r=Ye(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ve(this,e)});function i(){var e;Le(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ue(Ze(e=a.call.apply(a,[this].concat(r))),"onItemClick",(function(t){e.props.onItemClick(t,e.props.mapConfig)})),Ue(Ze(e),"renderResults",(function(){return e.props.results.map((function(t,r){var n,o=e.findService(t)||{},a=Se()(e.props.layers,{name:null===(n=o.options)||void 0===n?void 0:n.typeName}),i=(0,De.zA)(o),c=!(0,De.Tv)(a,o);return f().createElement(Ne,{subTitle:o.subTitle,idField:o.idField,displayName:o.displayName,key:t.osm_id||t.id||"res_"+r,item:t,onItemClick:e.onItemClick,tools:[{id:"open-gfi",keyProp:"open-gfi",visible:i,disabled:c,glyph:"info-sign",tooltipId:i&&c?"search.layerMustBeVisible":"search.showGFI",onClick:function(r){r.stopPropagation(),e.props.showGFI(t)}}]})}))})),Ue(Ze(e),"findService",(function(t){var r=e.props.searchOptions&&e.props.searchOptions.services;if(null!==t.__SERVICE__)if(r&&"string"==typeof t.__SERVICE__){for(var n=0;n<r.length;n++)if(r[n]&&r[n].id===t.__SERVICE__)return r[n];for(var o=0;o<r.length;o++)if(r[o]&&r[o].type===t.__SERVICE__)return r[o]}else if("object"===Fe(t.__SERVICE__))return t.__SERVICE__;return null})),e}return t=i,(r=[{key:"render",value:function(){var e=this.props.notFoundMessage;e||(e=f().createElement(xe.ZP.Message,{msgId:"noresultfound"}));var t=this.props.containerStyle,r=this.props.mapConfig&&this.props.mapConfig.size;if(this.props.fitToMapSize&&r){var n=r.width-this.props.sizeAdjustment.width,o=r.height-this.props.sizeAdjustment.height;t=l()({},this.props.containerStyle,{maxWidth:n,maxHeight:o})}return this.props.results?0===this.props.results.length?f().createElement("div",{className:"search-result-list",style:l()({padding:"10px",textAlign:"center"},t)},e):f().createElement("div",{className:"search-result-list",style:t},this.renderResults()):null}}])&&Me(t.prototype,r),i}(f().Component);Ue(Be,"propTypes",{results:s().array,layers:s().array,searchOptions:s().object,mapConfig:s().object,fitToMapSize:s().bool,containerStyle:s().object,sizeAdjustment:s().object,onItemClick:s().func,addMarker:s().func,afterItemClick:s().func,showGFI:s().func,notFoundMessage:s().oneOfType([s().object,s().string])}),Ue(Be,"defaultProps",{layers:[],sizeAdjustment:{width:0,height:110},containerStyle:{zIndex:1e3},onItemClick:function(){},addMarker:function(){},afterItemClick:function(){},showGFI:function(){}});var He=r(49977),qe=r(94707),ze=r.n(qe),We=r(35385),Ke=r.n(We),Xe=r(89734),$e=r.n(Xe),Je=r(14293),Qe=r.n(Je),et=r(75110),tt=r(21914),rt=r(80416),nt=r(86267),ot=r(15047),at=r(32420),it=r(88798),ct=r(7877);function lt(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ut(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ut(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach((function(t){ft(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dt=function(e,t){return(0,it.mx)(e,pt({},(0,ct.oq)(t)))},yt=r(26125);function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach((function(t){bt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vt(e){return function(e){if(Array.isArray(e))return gt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return gt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Et=r(827),Ot=r(63202),St=r(38560);function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rt(e,t){return!t||"object"!==_t(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ct(e){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function At(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ct(n);if(o){var r=Ct(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Rt(this,e)});function i(){return It(this,i),a.apply(this,arguments)}return t=i,(r=[{key:"render",value:function(){var e=this;return f().createElement(St.Z,{onClick:function(){return e.props.onToggle(e.props.pressed)},bsStyle:this.props.pressed?"default":"primary",className:"square-button"},f().createElement(_.Glyphicon,{glyph:"search"}))}}])&&Tt(t.prototype,r),i}(f().Component);At(wt,"propTypes",{pressed:s().bool,onToggle:s().func}),At(wt,"defaultProps",{pressed:!1,onToggle:function(){}});const jt=(0,d.connect)((function(e){return{pressed:e.controls&&e.controls.search&&e.controls.search.enabled||!1}}),{onToggle:g.Xi.bind(null,"search",null)})(wt);function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Nt,xt;function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(r),!0).forEach((function(t){Bt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lt(){return(Lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zt(e,t){return!t||"object"!==kt(t)&&"function"!=typeof t?Yt(e):t}function Yt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ht=(0,h.P1)([function(e){return e.search||null},function(e){return e.controls&&e.controls.searchBookmarkConfig||null},function(e){return e.mapConfigRawData||{}},function(e){return(null==e?void 0:e.searchbookmarkconfig)||""}],(function(e,t,r,n){return{enabledSearchBookmarkConfig:t&&t.enabled||!1,error:e&&e.error,coordinate:e&&e.coordinate||{},loading:e&&e.loading,searchText:e?e.searchText:"",activeSearchTool:o()(e,"activeSearchTool","addressSearch"),format:o()(e,"format")||Ot.ZP.getConfigProp("defaultCoordinateFormat"),selectedItems:e&&e.selectedItems,mapInitial:r,bookmarkConfig:n||{}}})),qt=(0,d.connect)(Ht,{onSearch:O.tt,onChangeCoord:O.TS,onChangeActiveSearchTool:O.a,onClearCoordinatesSearch:b.fU,onClearBookmarkSearch:S,onChangeFormat:O.Zw,onToggleControl:g.Xi,onZoomToPoint:O.Z,onPurgeResults:O.kV,onSearchReset:O.v2,onSearchTextChange:O.k9,onCancelSelectedItem:O.KG,onZoomToExtent:E.Px,onLayerVisibilityLoad:v.H0})((function(e){var t,r=e.activeSearchTool,n=void 0===r?"addressSearch":r,o=e.removeIcon,a=void 0===o?"1-close":o,i=e.searchIcon,c=void 0===i?"search":i,l=e.isSearchClickable,u=void 0===l||l,s=e.splitTools,p=e.searchText,d=void 0===p?"":p,y=e.maxResults,m=void 0===y?15:y,h=e.searchOptions,b=e.loading,v=e.delay,g=e.blurResetDelay,E=e.typeAhead,O=e.coordinate,S=void 0===O?{}:O,I=e.selectedItems,P=void 0===I?[]:I,A=e.defaultZoomLevel,w=void 0===A?12:A,j=e.enabledSearchBookmarkConfig,k=void 0!==j&&j,N=e.error,x=e.format,D=void 0===x?"decimal":x,M=e.placeholder,G=e.placeholderMsgId,V=void 0===G?"search.addressSearch":G,Z=e.showOptions,U=void 0===Z||Z,B=e.showAddressSearchOption,H=void 0===B||B,q=e.showCoordinatesSearchOption,z=void 0===q||q,W=e.showBookMarkSearchOption,K=void 0===W||W,$=e.onSearch,J=e.onSearchReset,Q=e.onSearchTextChange,ee=e.onCancelSelectedItem,te=e.onChangeCoord,re=void 0===te?function(){}:te,ne=e.onChangeActiveSearchTool,oe=void 0===ne?function(){}:ne,ie=e.onClearCoordinatesSearch,le=void 0===ie?function(){}:ie,ue=e.onChangeFormat,se=void 0===ue?function(){}:ue,pe=e.onToggleControl,de=void 0===pe?function(){}:pe,be=e.onZoomToPoint,ve=void 0===be?function(){}:be,Ee=e.onClearBookmarkSearch,Oe=void 0===Ee?function(){}:Ee,Se=e.onPurgeResults,_e=e.items,Ie=void 0===_e?[]:_e,Te=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,me),Pe=function(e){var t=e.searchText,r=e.selectedItems,n=e.searchOptions,o=e.maxResults,a=e.onSearch,i=void 0===a?function(){}:a,c=e.onSearchReset,l=void 0===c?function(){}:c;return function(){var e=t,a=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,r){var n;return t+((null==r||null===(n=r.options)||void 0===n?void 0:n.maxFeatures)||e)}),0)||e}(null==n?void 0:n.services,o);void 0!==e&&""!==e||r&&0!==r.length?void 0!==e&&""!==e&&i(e,n,a):l()}}({searchText:d,selectedItems:P,searchOptions:h,maxResults:m,onSearch:$,onSearchReset:J}),Re=function(){J()},Ce=[];if(H&&Ce.push(f().createElement(_.MenuItem,{active:"addressSearch"===n,onClick:function(){le({owner:"search"}),Oe("selected"),oe("addressSearch")}},f().createElement(_.Glyphicon,{glyph:c})," ",f().createElement(C.Z,{msgId:"search.addressSearch"}))),z&&Ce.push(f().createElement(fe.coordinatesMenuItem,{activeTool:n,searchText:d,clearSearch:Re,onChangeActiveSearchTool:oe,onClearBookmarkSearch:Oe})),K&&!T()(Ie)){var Ae,we=Te.bookmarkConfig||{},je=we.allowUser,ke=we.bookmarkSearchConfig,Ne=Ie.find((function(e){return"SearchByBookmark"===e.name}))||{};if(Ne.menuItem){var xe=Ne.menuItem;Ce.push(f().createElement(xe,null))}Ne.bookmarkConfig&&(t=ge(ge({},Ne.bookmarkConfig(de,k,n)),!je&&{visible:!1})),je||0!==(null==ke||null===(Ae=ke.bookmarks)||void 0===Ae?void 0:Ae.length)||"bookmarkSearch"!==n||oe("addressSearch")}var De,Fe=function(){if(U){if("coordinatesSearch"===n)return fe.coordinateFormatChange(D,se,U,n);if("bookmarkSearch"===n)return t}return null};return f().createElement(L,null,f().createElement(_.FormGroup,null,f().createElement("div",{className:"input-group",style:{display:"flex"}},P&&P.map((function(e,t){return f().createElement("span",{key:"selected-item"+t,className:"input-group-addon"},f().createElement("div",{className:"selectedItem-text"},e.text))})),f().createElement(Y,{show:"addressSearch"===n,delay:v,typeAhead:E,blurResetDelay:g,placeholder:M,placeholderMsgId:V,searchText:d,selectedItems:P,onSearch:Pe,onSearchTextChange:Q,onCancelSelectedItem:ee,onPurgeResults:Se}),"coordinatesSearch"===n&&z&&f().createElement(ye,{format:D,defaultZoomLevel:w,onClearCoordinatesSearch:le}),"bookmarkSearch"===n&&K&&f().createElement(ce,{mapInitial:Te.mapInitial}),f().createElement(X,{splitTools:!1,toolbarButtons:[].concat(he(Fe()?[ge({},Fe())]:[]),he(Ie.filter((function(e){return"button"===e.target})).map((function(e){var t=e.component;return{visible:!!U,Element:t}}))),[ge({glyph:a,className:"square-button-md no-border",bsStyle:"default",pullRight:!0,loading:!R()(b)&&b,visible:"addressSearch"===n&&(""!==d||P&&P.length>0),onClick:function(){"addressSearch"===n&&Re()}},"coordinatesSearch"===n&&fe.removeIcon(n,S,le,re)),ge(ge({glyph:c,className:"square-button-md no-border "+(u||"addressSearch"!==n?"magnifying-glass clickable":"magnifying-glass"),bsStyle:"default",pullRight:!0,tooltipPosition:"bottom",visible:!("addressSearch"!==n||(""!==d||P&&P.length>0)&&s),onClick:function(){return u&&Pe()}},"coordinatesSearch"===n&&fe.searchIcon(n,S,ve,w)),"bookmarkSearch"===n&&ae.searchIcon(n,Te)),{tooltip:(De=N,De?f().createElement(C.Z,{msgId:De.msgId||"search.generic_error",msgParams:{message:De.message,serviceType:De.serviceType}}):null),tooltipPosition:"bottom",className:"square-button-md no-border",glyph:"warning-sign",bsStyle:"danger",glyphClassName:"searcherror",visible:!!N,onClick:Re},{visible:U,renderButton:f().createElement(F,{disabled:U,menuItems:Ce})}])}))))})),zt=(0,h.P1)([Et.Od,et.l2,function(e){return e.search||null}],(function(e,t,r){return{mapConfig:e,layers:t,results:r?r.results:null}})),Wt=(0,d.connect)(zt,{onItemClick:O.Jc,addMarker:O._q,showGFI:O.w4})(Be),Kt=(0,d.connect)((function(e){return{enabled:e.controls&&e.controls.search&&e.controls.search.enabled||!1,selectedServices:e&&e.search&&e.search.selectedServices,selectedItems:e&&e.search&&e.search.selectedItems,textSearchConfig:e&&e.searchconfig&&e.searchconfig.textSearchConfig}}),{onUpdateResultsStyle:O.o$})((xt=Nt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(u,e);var t,r,n,a,c=(n=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ut(n);if(a){var r=Ut(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Zt(this,e)});function u(){var e;Mt(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Bt(Yt(e=c.call.apply(c,[this].concat(r))),"getServiceOverrides",(function(t){return e.props.selectedItems&&e.props.selectedItems[e.props.selectedItems.length-1]&&o()(e.props.selectedItems[e.props.selectedItems.length-1],t)})),Bt(Yt(e),"getSearchOptions",(function(){var t=e.props,r=t.searchOptions,n=t.textSearchConfig;return n&&n.services&&n.services.length>0?n.override?l()({},r,{services:n.services}):l()({},r,{services:r.services.concat(n.services)}):r})),Bt(Yt(e),"getCurrentServices",(function(){var t=e.props.selectedServices,r=e.getSearchOptions();return t&&t.length>0?l()({},r,{services:t}):r})),Bt(Yt(e),"getSearchAndToggleButton",(function(){var t=f().createElement(qt,Lt({key:"searchBar"},e.props,{searchOptions:e.getCurrentServices(),placeholder:e.getServiceOverrides("placeholder"),placeholderMsgId:e.getServiceOverrides("placeholderMsgId")}));return!0===e.props.withToggle?[f().createElement(jt,null)].concat(e.props.enabled?[t]:null):i()(e.props.withToggle)?f().createElement("span",null,f().createElement(m(),{query:"("+e.props.withToggle[0]+")"},f().createElement(jt,null),e.props.enabled?t:null),f().createElement(m(),{query:"("+e.props.withToggle[1]+")"},t)):t})),e}return t=u,(r=[{key:"componentDidMount",value:function(){this.props.onUpdateResultsStyle(Ft(Ft({},De.be),this.props.resultsStyle))}},{key:"render",value:function(){return f().createElement("span",null,this.getSearchAndToggleButton(),f().createElement(Wt,{fitToMapSize:this.props.fitResultsToMapSize,searchOptions:this.props.searchOptions,onUpdateResultsStyle:this.props.onUpdateResultsStyle,key:"nominatimresults"}))}}])&&Gt(t.prototype,r),u}(f().Component),Bt(Nt,"propTypes",{splitTools:s().bool,showOptions:s().bool,isSearchClickable:s().bool,fitResultsToMapSize:s().bool,searchOptions:s().object,resultsStyle:s().object,selectedItems:s().array,selectedServices:s().array,userServices:s().array,withToggle:s().oneOfType([s().bool,s().array]),enabled:s().bool,textSearchConfig:s().object}),Bt(Nt,"defaultProps",{searchOptions:{services:[{type:"nominatim",priority:5}]},isSearchClickable:!1,splitTools:!0,resultsStyle:{color:"#3388ff",weight:4,dashArray:"",fillColor:"#3388ff",fillOpacity:.2},fitResultsToMapSize:!0,withToggle:!1,enabled:!0}),xt));const Xt={SearchPlugin:l()(Kt,{OmniBar:{name:"search",position:1,tool:!0,priority:1}}),epics:{searchEpic:function(e){return e.ofType(O.bj).debounceTime(250).switchMap((function(t){return He.Observable.from((t.services||[{type:"nominatim",priority:5}]).map((function(e){var r=ot.b.Utils.getService(e.type);if(!r){var n=new Error("Service Missing");return n.msgId="search.service_missing",n.serviceType=e.type,He.Observable.of(n).do((function(e){throw e}))}return He.Observable.defer((function(){return r(t.searchText,e.options).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return pt(pt({},t),{},{__SERVICE__:e,__PRIORITY__:e.priority||0})}))}))})).retryWhen((function(e){return e.delay(200).scan((function(e,t){if(e>=2)throw t;return e+1}),0)}))}))).mergeAll().scan((function(e,t){return $e()([].concat(lt(e),lt(t)),["__PRIORITY__"])})).map((function(e){return(0,O.WN)(e.slice(0,t.maxResults||15),!1)})).startWith((0,O.yo)(!0)).takeUntil(e.ofType(O.Av,O.M8,O.dX)).concat([(0,O.yo)(!1)]).catch((function(e){var t=pt(pt({msgId:"search.generic_error"},e),{},{message:e.message,stack:e.stack});return He.Observable.from([(0,O.kE)(t),(0,O.yo)(!1)])}))}))},searchOnStartEpic:function(e,t){return e.ofType(O.Vc).switchMap((function(e){var r=e.layer,n=e.cql_filter,o=t.getState();if(0===(0,et.OX)(o).filter((function(e){return e.name===r})).length)return He.Observable.of((0,O.Tw)());var a=(0,et.dT)(o,r);return a&&n?He.Observable.defer((function(){return(0,at.DH)(a.url,{maxFeatures:1,typeName:r,srsName:"EPSG:4326",outputFormat:"application/json",cql_filter:n}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.features&&e.features.length&&pt(pt({},e.features[0]),{},{typeName:r})}))})).switchMap((function(e){var t=e.type,r=e.geometry,o=e.typeName,a=Ke()({type:t,geometry:r}).geometry.coordinates,i={lng:a[0],lat:a[1]};return a?He.Observable.of((0,tt.lK)({latlng:i},o,[o],ft({},o,{cql_filter:n})),(0,tt.HP)()):He.Observable.empty()})).catch((function(){return He.Observable.of((0,O.I3)())})):He.Observable.empty()}))},searchItemSelected:function(e,t){return e.ofType(O.dX).switchMap((function(e){var r=He.Observable.of(e.item).concatMap((function(t){if(t&&t.__SERVICE__&&t.__SERVICE__.geomService){var r=(0,_e.generateTemplateString)(t.__SERVICE__.geomService.options.staticFilter||"")(t);return He.Observable.fromPromise(ot.b.Utils.getService(t.__SERVICE__.geomService.type)("",l()({},t.__SERVICE__.geomService.options,{staticFilter:r})).then((function(e){return l()({},t,{geometry:nt.default.mergeToPolyGeom(e)})})))}return He.Observable.of(e.item)})).concatMap((function(e){var r=e.bbox||e.properties.bbox||ze()(e),n=[(0,E.Px)([r[0],r[1],r[2],r[3]],"EPSG:4326",e.__SERVICE__&&e.__SERVICE__.options&&e.__SERVICE__.options.maxZoomLevel||21),(0,O._q)(e)];if(e.__SERVICE__&&!Qe()(e.__SERVICE__.launchInfoPanel)&&e.__SERVICE__.options&&e.__SERVICE__.options.typeName){var o=Ke()(e).geometry.coordinates,a={lng:o[0],lat:o[1]},i=e.__SERVICE__.options.typeName;if(o){var c=t.getState(),l=i&&(0,et.dT)(c,i),u=null,s=[],p={},f=!1;return"single_layer"===e.__SERVICE__.launchInfoPanel&&(f=e.__SERVICE__.forceSearchLayerVisibility,s=[i],u=e.id,p=ft({},e.__SERVICE__.options.typeName,{info_format:dt(l,c),featureid:u})),[].concat(lt(f&&l?[(0,rt.He)(l.id,{visibility:!0})]:[]),lt(e.__SERVICE__.openFeatureInfoButtonEnabled?[]:[(0,tt.lK)({latlng:a},i,s,p,u)]),[(0,tt.HP)()],n)}}return n})),n=e.item,o=n&&n.__SERVICE__&&n.__SERVICE__.then,a=o?He.Observable.of((0,O.QJ)(o.map((function(e){return pt(pt({},e),{},{options:pt({item:n},e.options)})})),{text:(0,_e.generateTemplateString)(n.__SERVICE__.displayName||"")(n),placeholder:n.__SERVICE__.nestedPlaceholder&&(0,_e.generateTemplateString)(n.__SERVICE__.nestedPlaceholder||"")(n),placeholderMsgId:n.__SERVICE__.nestedPlaceholderMsgId&&(0,_e.generateTemplateString)(n.__SERVICE__.nestedPlaceholderMsgId||"")(n)},(0,_e.generateTemplateString)(n.__SERVICE__.searchTextTemplate||"")(n))):He.Observable.empty(),i=n.__SERVICE__&&n.__SERVICE__.searchTextTemplate,c=i?He.Observable.of((0,O.k9)((0,_e.generateTemplateString)(i)(n))):He.Observable.empty();return He.Observable.of((0,O.kV)()).concat(r,a,c)}))},zoomAndAddPointEpic:function(e,t){return e.ofType(O.b4).switchMap((function(e){var r={type:"Feature",geometry:{type:"Point",coordinates:[e.pos.x,e.pos.y]}},n=t.getState();return He.Observable.from([(0,b.W)("search","search","overlay",{features:[r],type:"vector",name:"searchPoints",id:"searchPoints",visibility:!0,style:n.search&&n.search.style||De.be}),(0,E.xy)(e.pos,e.zoom,e.crs)])}))},textSearchShowGFIEpic:function(e,t){return e.ofType(O.al).switchMap((function(e){var r,n,o,a,i,c,l=e.item,u=t.getState(),s=null==l||null===(r=l.__SERVICE__)||void 0===r||null===(n=r.options)||void 0===n?void 0:n.typeName,p=s&&(0,et.dT)(u,s),f=l.bbox||l.properties.bbox||ze()(l),d=Ke()(l).geometry.coordinates,y={lng:d[0],lat:d[1]},m=l.id;return d&&(0,De.zA)(null==l?void 0:l.__SERVICE__)&&(0,De.Tv)(p,null==l?void 0:l.__SERVICE__)?(o=He.Observable).of.apply(o,lt(null!=l&&null!==(a=l.__SERVICE__)&&void 0!==a&&a.forceSearchLayerVisibility&&p?[(0,rt.He)(p.id,{visibility:!0})]:[]).concat([(0,tt.lK)({latlng:y},s,[s],ft({},s,{info_format:dt(p,u),featureid:m}),m),(0,tt.HP)(),(0,E.Px)([f[0],f[1],f[2],f[3]],"EPSG:4326",(null==l||null===(i=l.__SERVICE__)||void 0===i||null===(c=i.options)||void 0===c?void 0:c.maxZoomLevel)||21),(0,O._q)(l)])):He.Observable.empty()}))}},reducers:{search:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case O.NN:return l()({},t,{loading:r.loading});case O.O7:return l()({},t,{error:r.error});case O.gs:return l()({},t,{searchText:r.searchText,error:null});case O.p7:var n=r.results;return!0===r.append&&t&&t.results&&(n=[].concat(vt(t.results),vt(r.results))),l()({},t,{results:n,error:null});case O.Av:return l()({},t,{results:null,error:null});case O.wn:var o=r.markerPosition.latlng?{latlng:r.markerPosition.latlng,lat:r.markerPosition.latlng.lat,lng:r.markerPosition.latlng.lng}:r.markerPosition;return l()({},t,{markerPosition:o,markerLabel:r.markerLabel});case O.Gh:return l()({},t,{highlightedFeature:r.highlightedFeature});case O.M8:return{style:t.style||{}};case g.l:return null;case O.C2:return l()({},t,{selectedServices:r.services,searchText:r.searchText,selectedItems:(t.selectedItems||[]).concat(r.items)});case O.oQ:return t?l()({},{selectedItems:t.selectedItems&&t.selectedItems.filter((function(e){return e!==r.item})),searchText:""===t.searchText&&r.item&&r.item.text?r.item.text.substring(0,r.item.text.length):t.searchText}):t;case O.x2:return l()({},t,{style:r.style});case O.Y7:return ht(ht({},t),{},{activeSearchTool:r.activeSearchTool});case O.GI:return ht(ht({},t),{},{format:r.format});case O.KP:return ht(ht({},t),{},{coordinate:ht(ht({},t.coordinate),{},bt({},r.coord,r.val))});case O.dS:return l()({},t,{markerPosition:null!=t&&null!==(e=t.markerPosition)&&void 0!==e&&e.latlng?{}:null==t?void 0:t.markerPosition});default:return t}},mapInfo:yt.Z}}}}]);